<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ - Ù†Ø¸Ø§Ù… Ø§Ù„Ø·Ù„Ø§Ø¨</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <style>
    /* Ù†ÙØ³ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù…Ø¹ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¨Ø³ÙŠØ·Ø© */
    body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
    .card{background:#fff;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,.3);max-width:450px;width:100%;padding:40px;text-align:center}
    .title{font-size:28px;color:#333;margin-bottom:10px}
    .subtitle{color:#666;margin-bottom:30px;font-size:15px}
    .form-group{margin-bottom:25px;text-align:right}
    label{display:block;margin-bottom:8px;font-weight:600;color:#333;font-size:14px}
    .form-control{width:100%;padding:15px;border:2px solid #e0e0e0;border-radius:12px;font-size:16px;transition:all .3s}
    .form-control:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,.1)}
    select.form-control{background:#f8f9fa}
    .btn{width:100%;padding:15px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;margin-top:10px;transition:all .3s}
    .btn:hover{transform:translateY(-2px);box-shadow:0 10px 25px rgba(102,126,234,.4)}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .alert{padding:15px;border-radius:10px;margin:20px 0;display:none;font-size:14px}
    .alert-success{background:#d4edda;color:#155724;border:1px solid #c3e6cb}
    .alert-error{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}
    .alert.show{display:block}
    .link{margin-top:20px}
    .link a{color:#667eea;text-decoration:none;font-weight:600}
  </style>
</head>
<body>
  <div class="card">
    <h1 class="title">ğŸ“ ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h1>
    <p class="subtitle">Ø£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨Ùƒ ÙƒÙ…Ø¯ÙŠØ± Ø£Ùˆ Ù…Ø¹Ù„Ù…</p>

    <div id="alert" class="alert"></div>

    <form id="registerForm">
      <div class="form-group">
        <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ <span style="color:red">*</span></label>
        <input type="email" id="email" class="form-control" placeholder="example@school.com" required>
      </div>

      <div class="form-group">
        <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± <span style="color:red">*</span></label>
        <input type="password" id="password" class="form-control" placeholder="ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ©" required>
      </div>

      <div class="form-group">
        <label>ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± <span style="color:red">*</span></label>
        <input type="password" id="confirmPassword" class="form-control" placeholder="Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
      </div>

      <div class="form-group">
        <label>Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨ <span style="color:red">*</span></label>
        <select id="role" class="form-control" required>
          <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨</option>
          <option value="principal">Ù…Ø¯ÙŠØ± Ù…Ø¯Ø±Ø³Ø©</option>
          <option value="teacher">Ù…Ø¹Ù„Ù…</option>
        </select>
      </div>

      <div class="form-group">
        <label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© <span style="color:red">*</span></label>
        <input type="text" id="schoolId" class="form-control" placeholder="Ù…Ø«Ø§Ù„: SCH-001" required>
      </div>

      <button type="submit" class="btn" id="submitBtn">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
    </form>

    <div class="link">
      <a href="index.html">Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
    </div>
  </div>

  <script>
    // ğŸ”¥ Ø¶Ø¹ Ù‡Ù†Ø§ firebaseConfig Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù…Ù† Firebase Console
    const firebaseConfig = {
      // Ù…Ø«Ø§Ù„:
      // apiKey: "AIza...",
      // authDomain: "tullab.firebaseapp.com",
      // projectId: "tullab",
      // ... (Ø§Ù†Ø³Ø® Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ù† Firebase Console)
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    document.getElementById('registerForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      const role = document.getElementById('role').value;
      const schoolId = document.getElementById('schoolId').value;
      const submitBtn = document.getElementById('submitBtn');
      const alert = document.getElementById('alert');

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±
      if (password !== confirmPassword) {
        showAlert('ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©', 'error');
        return;
      }

      if (password.length < 6) {
        showAlert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
        return;
      }

      submitBtn.disabled = true;
      submitBtn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡...';

      try {
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
        const user = userCredential.user;

        // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Firestore
        await db.collection('users').doc(user.uid).set({
          email: email,
          role: role,
          schoolId: schoolId,
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        showAlert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.', 'success');
        setTimeout(() => window.location.href = 'index.html', 2000);

      } catch (error) {
        let message = 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
        switch (error.code) {
          case 'auth/email-already-in-use':
            message = 'Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„';
            break;
          case 'auth/weak-password':
            message = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ© Ø¬Ø¯Ø§Ù‹';
            break;
          case 'auth/invalid-email':
            message = 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­';
            break;
        }
        showAlert(message, 'error');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨';
      }
    });

    function showAlert(message, type) {
      const alert = document.getElementById('alert');
      alert.textContent = message;
      alert.className = `alert alert-${type} show`;
      setTimeout(() => alert.classList.remove('show'), 5000);
    }
  </script>
</body>
</html>
